# FlowerKnightGirlPlayer
某寢室再生機。

## 動作要件
- Windows 10 以降のWindows OS
- MSVC 2015-2022 (x64)

## 再生方法

メニュー欄`File -> Select file` から台本ファイル(`*.txt`)を選んで下さい。  
台本ファイル読み取り後、次の相対位置に関連ファイルがあると想定して場面の再生を開始します。
<pre>
...
├ Episode
│  ├ 100001.txt // 台本ファイル
│  ├ 100001_2.txt
│  └ ...
└ Resource
    ├ 100001 // 音声フォルダ
    │  ├ fkg_100001_hscene001.mp3
    │  ├ ...
    │  ├ fkg_100001_hscene201.mp3
    │  └ ...
    ├ ...
    ├ hscene_r18 // 静画フォルダ
    │  ├ r18_100001_000.png
    │  ├ r18_100001_001.png
    │  ├ r18_100001_100.png
    │  └ ...
    └ hscene_r18_spine // Spine素材フォルダ
       ├ r18_spine_100011_000.atlas
       ├ r18_spine_100011_000.json
       ├ r18_spine_100011_000.png // 中身はwebp形式
       ├ r18_spine_100011_000_2.png
       └ ...
</pre>

## マウス機能

| 入力 | 機能 |
----|---- 
マウスホイール| 拡大・縮小。
左ボタン + マウスホイール| (静画) 機能なし。 <br> (動画) 加速・減速。
左ボタンクリック| (静画) 次の画像に切り替え。 <br> (動画) 次の動作に切り替え。
左ボタンドラッグ|(静画) 表示位置移動。ディスプレイ解像度以上に拡大した場合のみ動作。<br>(動画) 視点移動。
中ボタンクリック|(静画) 原寸大表示。<br> (動画) 尺度・視点・速度初期化。
右ボタン + マウスホイール|文章送り・戻し。
右ボタン + 中ボタンクリック|窓枠消去・表示。消去時にはディスプレイ原点位置に移動。
右ボタン + 左ボタンクリック|窓移動。窓枠消去時のみ動作。

## キーボード機能
| 入力 | 機能 |
----|---- 
Esc| 終了。
| Up | 次の台本ファイルを開く。 |
| Down | 前の台本ファイルを開く。 |
| C   | 文字色黒・白切り替え。 |
| T   | 文章表示・非表示切り替え。 |

例えば`100011.txt`を再生していた場合、キー操作で`100001_2.txt`や`100011_2.txt`の再生に移ることができます。
<pre>
Episode
├ 100001_2.txt
├ 100011.txt
├ 100011_2.txt
└ ...
</pre>

## 使用ライブラリ

- [DXライブラリ](https://dxlib.xsrv.jp/dxdload.html)
- [spine-cpp 3.8](https://github.com/EsotericSoftware/spine-runtimes/tree/3.8)

ビルドを行う際はプロジェクト階層下に補って下さい。
<pre>
FlowerKnightGirlPlayer
  ├ deps
  │  ├ dxlib // static libraries and headers of DXライブラリ
  │  │ └ ...
  │  └ spine-cpp // sources and headers of spine-cpp 3.8
  │    ├ include
  │    │ └ ...
  │    └ src
  │      └ ...
  ├ adv.h
  └ ...
</pre>

## 補足説明
- 解像度
  -  再生開始前に双三次補間を掛けて拡大しています。但し、再生開始後の拡縮の際の補間は双線形補間になります。
- 紋理 (Texture)
  -  Spine側によるファイル検索の都合上、拡張子は`.png`としていますが中身は`webp`形式です。
- 文章表示
  - `游明朝`が搭載されている必要があります。 
